{% extends "layout2.html" %}

      <meta name="viewport" content="initial-scale=1, width=device-width">
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

{% block body %}
<script>
     function validate(){
           if(document.getElementById("pic").value != "") {
                 let label = document.getElementById("pic_label")
                 label.style.background = "green";
           }
     }
 </script>
<style>
     label {
          padding: 10px;
          background-color:  rgb(239, 237, 237);
          border-radius: 10px;
     }
     #label_cont{
          margin: 30px 0px 20px 0px;
     }
     .c_img {
          margin-top: -10px;
          width: 96vw;
          height: auto;
          min-height: 50px;
          margin-left: 12px;
          margin-right: 20px;
          max-width: 700px;
          padding: 10px 10px 10px 10px;
     }
     .main_img {
          margin-top: -10px;
          width: 96vw;
          height: auto;
          min-height: 50px;
          margin-left: 12px;
          margin-right: 20px;
          max-width: 700px;
          padding: 10px 10px 10px 10px;
          margin-bottom: 20px;
          border-bottom-left-radius: 20px;
          border-bottom-right-radius: 20px;
     }
     .c_post{
          display: block;
          background-color: rgb(212, 214, 215);
          width: vw - 40;
          height: auto;
          min-height: 50px;
          margin-left: 20px;
          margin-right: 20px;
          max-width: 700px;
          border-top-left-radius: 20px;
          border-top-right-radius: 20px;
          padding: 10px 10px 10px 10px;
          text-align: center;
          font-size: 20px;
          word-wrap: break-word;
     }
     .container{
          display: flex;
          width: vw-40;
          margin-left: 20px;
          margin-right: 20px;
     }
     html {
          scroll-behavior: smooth;
     }
     .a{
          margin-left: 55px;
     }
     .div{
          display: block;
          background-color: rgb(212, 214, 215);
          width: vw - 40;
          height: auto;
          min-height: 50px;
          margin-left: 20px;
          margin-right: 20px;
          max-width: 700px;
          border-top-right-radius: 20px;
          border-top-left-radius: 20px;
          padding: 10px 10px 10px 10px;
          text-align: center;
          font-size: 20px;
          word-wrap: break-word;
     }
     .react{
          margin-bottom: 30px;
          height: 50px;
          width: 46vw;
          max-width: 345px;
          padding: 5px 5px 5px 5px;
          text-align: center;
          display: block;
          background-color: rgb(27, 153, 207);
          border-bottom-left-radius: 20px;
     }
     .comment{
          margin-left: 10px;
          margin-bottom: 30px;
          height: 50px;
          width: 46vw;
          max-width: 345px;
          padding: 5px 5px 5px 5px;
          text-align: center;
          display: block;
          background-color: rgb(162, 162, 162);
          border-bottom-right-radius: 20px;
     }
</style>
<script>
    function get_int(input){
         num = ""
        for (let i = 0; i < input.length; i++) {
            if (input[i]== "ðŸ–¤"){
                break
            } else{
                num += input[i]
            }
        }
        return parseInt(num)
     }
     function like(input){
          let box = document.getElementById(input)

          if (box.getAttribute('value') == "True") {
               box.innerHTML = (get_int(box.textContent) - 1) + "ðŸ–¤"
               box.setAttribute('value', "False")
               let url = window.location.origin
               let request = new XMLHttpRequest();
               let body = document.querySelector('#body');
               request.open("GET", url + "/unlike/" + input);
               request.send();

          } else {
               box.setAttribute('value', "True")
               box.innerHTML = (get_int(box.textContent) + 1) + "â¤ï¸"
               let url = window.location.origin
               let request = new XMLHttpRequest();
               let body = document.querySelector('#body');
               request.open("GET", url + "/like/" + input);
               request.send();

          }
     }
</script>
<a class="a" href="/profile/{{current_post[0]}}">{{current_post[0]}}</a>
<div class="c_post">
     {{current_post[1]}}
</div>
{% if current_post[3] == "True" %}
     <img src="/static/{{current_post[4]}}.jpg" class="main_img">
{% endif %}

<form action="/comment/{{current_post[2]}}" method="post" enctype="multipart/form-data">
     <center>
          <textarea required="" class="btn btn-outline-light" name="comment" maxlength="1000" style="padding: 10px; width:500px; height: 200px; border-radius: 10px;"></textarea>
     </center>
     <center>
          <input type="file" id="pic" onchange="validate()" name="pic" accept="image/*" value="" hidden>
          <div id="label_cont">
               <label for="pic" id="pic_label">Upload Picture &#128206;</label>
          </div>
     </center>
     <center>
          <button  type="submit" id='button' class="btn btn-outline-light" data-mdb-ripple-color="dark" style="font-size: 60px; color: black; border: 0ch; margin-bottom: 2%; border-radius: 10px 10px 10px 10px;  width: 200px; height: 50px;">Comment</button>
     </center>
</form>

{% for i in comments %}
     <a class="a" href="/profile/{{i[2]}}">{{i[2]}}</a>
     <div class="div">
          {{i[3]}}
     </div>
     {% if i[8] == "True" %}
          <img src="/static/{{i[1]}}.jpg" class="c_img">
     {% endif %}
     <div class="container">
          <p class="react" value="{{i[6]}}" id="{{i[1]}}" onclick="like({{i[1]}})">{{i[5]}}</p>
          <a href="/comment/{{i[1]}}"><p class="comment">{{i[7]}} Comments</p></a>
     </div>
{% endfor %}
{% endblock %}